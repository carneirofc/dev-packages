sudo: required
language: python
python:
    - 3.6.8
branches:
  only:
  - master
script:
  - pip install -r requirements.txt
  - git clone https://github.com/lnls-sirius/eth-bridge-pru-serial485.git
  - cd eth-bridge-pru-serial485/client
  - python setup.py install
  - cd ../../
  - git clone https://github.com/lnls-fac/mathphys.git
  - cd mathphys
  - python setup.py install
  - cd ../
  - cd siriuspy
  - python setup.py test
  - git describe --tags | sed -e 's/^v//g' > siriuspy/VERSION
deploy:
  skip_cleanup: true
  provider: pypi
  username: __token__
  password:
    secure: "AylWPRIogUexNfr8XJjJ4aYKi/I6vsQZQnVUpkgiqSDjaLdus7PEu4oIt36JJyQdoSHRWkmqiJvZvMSG7WyDHoj4bCize2VHIX6NzqbSsAKqQzHHl640aXOYfccN8RxdwKfOgTnH1wG0ypoc+q/tqQBhY3i0BQe6AD2IayuOXFF3hOgQ/JhlYRDNgSI6Y8iBjaNWOasICaxrGXwfnJTcdBW2rqL+Jc1Hra263cqifXZJMx3O7WXFdKw1XhWB8zxLo5BxnfzXVt8ONPw0lhz96g8zZ6Pi0/YdqfPpIc4APwJhmeY9fbVlXVbSd1q1jcy//wKRkQtlCkzGHtEexcs9PUzpCYd2nXZS5wFVTbA5FDMWdNY83dShMk/F4plKCcnxVVK+K18gGYA7YW8yI9e8jWG6Ju+L/fSQl3/9tbC91V8l6p9V78MzIAUIik1PImZqSwVAdHTkoZDzIEa9aR0G60u6yJSDkEtvNVlLLlduBfDzaE+aztRoLS4GEdeFpekAGSYqTON8f+z7hlx+z7gjxze49zBKZrEgrvdGNsXlxnJhU2qIFfK4jxl8NnX86KxlZKs2ZunO9WQAEvZK5g9Gim9Zz5gZ9q4ecLkZNVpXeNsStQQonOXnxauscuZKf/kI7NAxqosjxH+RYneYiFaXXg6pjHlJKS5+9bAxCs5fnTo="
  on:
    tags: true
    branch: PR-pypi-support
